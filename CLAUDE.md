# CLAUDE.md - Phase 1: Quick Start Implementation

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## üöÄ Quick Start (5-Minute Essentials) - NEW USERS START HERE

### ‚ö° Immediate Session Start (Copy-Paste Ready)
```bash
# 1. MANDATORY constraint verification (ALWAYS FIRST)
python scripts/pre_action_check.py --strict-mode || exit 1

# 2. Load essential constraints (minimum required)
echo "Loading core constraints..."
[ -f memory-bank/00-core/user_authorization_mandatory.md ] && echo "‚úÖ User auth rules found"
[ -f memory-bank/00-core/testing_mandatory.md ] && echo "‚úÖ Testing rules found"
[ -f memory-bank/00-core/code_quality_anti_hacking.md ] && echo "‚úÖ Quality rules found"
[ -f memory-bank/09-meta/progress_recording_mandatory_rules.md ] && echo "‚úÖ Progress recording rules found"

# 3. Cognee strategic integration (knowledge management optimization)
if mcp__cognee__cognify_status > /dev/null 2>&1; then
    mcp__cognee__cognee_add_developer_rules --base_path /home/devuser/workspace
    echo "‚úÖ Cognee enhanced mode active"
    
    # Performance check
    start_time=$(date +%s)
    mcp__cognee__search "performance test" GRAPH_COMPLETION >/dev/null 2>&1
    end_time=$(date +%s)
    response_time=$((end_time - start_time))
    
    if [[ $response_time -gt 10 ]]; then
        echo "‚ö†Ô∏è COGNEE PERFORMANCE: Slow response detected (${response_time}s)"
        echo "üöÄ Optimization: memory-bank/01-cognee/search_speed_optimization_and_indexing_strategy.md"
        echo "üìà Expected: 80% speed improvement, 70% efficiency gain"
    else
        echo "üéØ Cognee optimal performance confirmed"
    fi
    
    echo "üìö Strategic utilization: memory-bank/01-cognee/cognee_effective_utilization_strategy.md"
else
    echo "üö® COGNEE CRITICAL: Database unavailable or empty"
    echo "üìã Emergency reconstruction (45min): memory-bank/01-cognee/cognee_reconstruction_successful_procedure.md"
    echo "‚ö° Quick start: mcp__cognee__prune && mcp__cognee__cognee_add_developer_rules"
    echo "üéØ Strategic guide: memory-bank/01-cognee/cognee_effective_utilization_strategy.md"
    echo "‚ö†Ô∏è Fallback: Direct constraint mode only"
fi

echo "üéØ Session ready! You can now start development."
```

### üß† Core Principles (Absolute Compliance)
```bash
# The 5-Point Evaluation Rule (MANDATORY before ANY action)
echo "üö® 0. SECURITY: Will this expose API keys, secrets, or credentials? ‚Üí STOP if yes"
echo "üéØ 1. USER VALUE: Does this serve USER's interests, not Claude's convenience?"
echo "‚è∞ 2. TIME HORIZON: Long-term value vs short-term convenience evaluated?"
echo "üîç 3. FACT CHECK: Is this fact or speculation?"
echo "üìö 4. KNOWLEDGE: Have I verified related knowledge?"
echo "üé≤ 5. ALTERNATIVES: Is there a more reliable/valuable method?"

# MINDSET PRINCIPLES (absolute compliance)
EXCELLENCE_MINDSET=("User benefit FIRST" "Long-term value PRIORITY" "Lazy solutions FORBIDDEN")

# SECURITY FORBIDDEN COMMANDS (auto-stop on detection)
SECURITY_FORBIDDEN=("env.*API" "cat.*key" "echo.*token" "grep.*secret" "printenv.*KEY")

# FORBIDDEN PHRASES (auto-stop on detection)
FORBIDDEN=("probably" "maybe" "I think" "seems like" "„Åü„Å∂„Çì" "„Åä„Åù„Çâ„Åè")

# FACT-BASED VERIFICATION (see detailed rules in Cognee)
# For implementation details, query: mcp__cognee__search --search_query "documentation accuracy verification rules" --search_type "GRAPH_COMPLETION"
```

### üéØ Value Assessment Framework (MANDATORY)
```bash
# Multi-dimensional Evaluation (required for ALL proposals)
echo "=== VALUE ASSESSMENT FRAMEWORK ==="
echo "1. üßë‚Äçüíº USER BENEFIT: How does this serve the user's actual needs?"
echo "2. ‚è≥ LONG-TERM VALUE: Sustainable vs quick-fix solution?"
echo "3. üîÑ COMPREHENSIVE: All aspects considered (security, quality, efficiency)?"
echo "4. üö´ LAZINESS CHECK: Am I avoiding hard work that benefits the user?"
echo "================================="
```

### ‚ö° 3-Second Delegation Decision
| Context Size | Duration | State Required | ‚Üí Use |
|--------------|----------|----------------|-------|
| >2000 tokens | <30 min | No | **Task Tool** |
| Any | ‚â•30 min | Yes | **tmux + Claude CLI** |
| <2000 tokens | <30 min | No | **Direct Execution** |

### üèÜ Competitive Organization (Advanced Mode)
```bash
# Ë§áÈõë„ÉªÈáçË¶ÅË™≤È°å„Åß„ÅÆÁ´∂‰∫âÁöÑËß£Ê±∫„Ç∑„Çπ„ÉÜ„É†
# When: Ë§áÊï∞„Ç¢„Éó„É≠„Éº„ÉÅ„ÉªÊúÄÈ´òÂìÅË≥™„ÅåÂøÖË¶Å„Å™Â†¥Âêà

# „Ç∑„Çπ„ÉÜ„É†Á¢∫Ë™ç
tmux --version && git --version

# „Ç≥„É≥„ÉöÊñπÂºèËµ∑Âãï
./scripts/tmux_worktree_setup.sh issue-123
./scripts/tmux_session_start.sh issue-123

# ‰ΩìÂà∂: 14ÂΩπÂâ≤„Éª4„ÉÅ„Éº„É†„Éª‰∏¶ÂàóÂÆüË°å„ÉªÂ§öËßíË©ï‰æ°
echo "üìö Complete framework: memory-bank/02-organization/competitive_organization_framework.md"
echo "üîß Technical setup: memory-bank/02-organization/tmux_git_worktree_technical_specification.md"
echo "üë• Roles & workflows: memory-bank/02-organization/competitive_roles_workflows_specification.md"
echo "üèÖ Quality evaluation: memory-bank/04-quality/competitive_quality_evaluation_framework.md"
```

### üîß Essential Commands (Most Used)
```bash
# Start development environment
poetry install && poetry shell

# Run tests with coverage
pytest --cov=app --cov-report=html

# Quality check before commit
flake8 app/ tests/ && black app/ tests/ --check && mypy app/

# TDD cycle (Red-Green-Refactor)
# 1. Write failing test first
# 2. Minimal implementation 
# 3. Refactor for quality

# Cognee strategic utilization (knowledge management)
mcp__cognee__cognify_status                 # Status check
mcp__cognee__search "query" GRAPH_COMPLETION # Strategic search
mcp__cognee__cognee_add_developer_rules     # Load core knowledge

# Cognee emergency & optimization  
mcp__cognee__prune && sleep 5               # Emergency reset
time mcp__cognee__search "test" CHUNKS      # Performance test
```

**üéØ That's it! You're ready to develop. For detailed procedures, see sections below.**

---

## üìñ Navigation Guide

**Choose your path based on your needs:**

| Your Role | Time Available | ‚Üí Go To Section |
|-----------|----------------|-----------------|
| **New User** | 5 minutes | ‚úÖ **You're done! Start coding above** |
| **Need Setup Details** | 15 minutes | üìã [Essential Protocols](#essential-protocols) |
| **Implementing Features** | 30+ minutes | üîß [Detailed Implementation](#detailed-implementation) |
| **Looking for Commands** | As needed | üìö [Reference & Examples](#reference--examples) |

---

## üìã Essential Protocols (Mandatory Execution)

### üö® Critical Session Initialization (DETAILED VERSION)

**Only read this if Quick Start above wasn't sufficient.**

#### Phase 1A: Core Compliance Rules (MUST READ FIRST)
```bash
# MANDATORY reading order - DO NOT skip or reorder
1. memory-bank/00-core/user_authorization_mandatory.md        # User authorization + Security + Mindset (absolute compliance)
2. memory-bank/00-core/value_assessment_mandatory.md          # Value evaluation framework (absolute compliance)
3. memory-bank/00-core/testing_mandatory.md                  # Automated testing requirements  
4. memory-bank/00-core/code_quality_anti_hacking.md          # Quality anti-hacking rules
5. memory-bank/09-meta/progress_recording_mandatory_rules.md # Progress recording requirements
```

#### Phase 1B: Core Development Knowledge
```bash
5. memory-bank/00-core/tdd_implementation_knowledge.md       # TDD implementation methods
6. memory-bank/00-core/development_workflow.md              # Development workflow
7. memory-bank/01-cognee/memory_resource_management_critical_lessons.md  # Memory resource management

# üö® CogneeÂ∞ÇÈñÄÈÅãÁî®Áü•Ë≠òÔºàÁ∑äÊÄ•ÊôÇ„ÉªÊà¶Áï•Á´ãÊ°àÊôÇÔºâ
8. memory-bank/01-cognee/cognee_reconstruction_successful_procedure.md  # 14„Éï„Ç°„Ç§„É´45ÂàÜÂæ©ÊóßÂÆüË®º„Éó„É≠„Éà„Ç≥„É´
9. memory-bank/01-cognee/search_speed_optimization_and_indexing_strategy.md  # Ê§úÁ¥¢80%È´òÈÄüÂåñÁµ±ÂêàÊà¶Áï•
```

#### Key Additional Files (Load as needed)
```bash
# Architecture & Quality
memory-bank/a2a_protocol_implementation_rules.md        # A2A protocol implementation
memory-bank/critical_review_framework.md                # Critical review framework
memory-bank/accuracy_verification_rules.md              # Documentation accuracy verification

# Advanced Patterns & Tools (For experienced users)
memory-bank/tmux_claude_agent_organization_rules.md     # tmux organization rules
memory-bank/agent_peer_review_protocol.md               # Agent peer review protocol
```

### üîÑ 3-Layer Architecture (Simplified)

#### Layer 1: Direct Constraints (MANDATORY)
```bash
# Verify constraint files exist
ls -la memory-bank/*_mandatory_rules.md

# Execute mandatory validation
python scripts/pre_action_check.py --strict-mode
```

#### Layer 2: Cognee Intelligence (SUPPLEMENTARY)
```bash
# If Cognee available
if mcp__cognee__cognify_status > /dev/null 2>&1; then
    mcp__cognee__cognee_add_developer_rules --base_path /home/devuser/workspace
    mcp__cognee__search --search_query "relevant context" --search_type "GRAPH_COMPLETION"
else
    echo "‚ö†Ô∏è Using direct constraint mode"
fi
```

#### Layer 3: tmux Development Flow (OPTIONAL)
```bash
# Check tmux state (only if using multiple agents)
tmux list-sessions
tmux list-panes -F "#{pane_index}: #{pane_title}"

# Safe command sending (CRITICAL: separate message and Enter)
tmux send-keys -t <pane> '<command>'
tmux send-keys -t <pane> Enter
```

### üéØ Working Principles (Core Mindset)

#### Fact-Based Decision Enforcement
- ‚ùå **FORBIDDEN**: Speculation ("probably", "maybe", "I think")
- ‚ùå **FORBIDDEN**: Surface-level solutions without root cause analysis
- ‚úÖ **REQUIRED**: Objective fact-based logical analysis
- ‚úÖ **REQUIRED**: Root cause identification and fundamental solutions

#### Quality Gates (NON-NEGOTIABLE)
```bash
# Before EVERY commit
python scripts/verify_accuracy.py
python scripts/quality_gate_check.py
pytest --cov=app --cov-fail-under=85
flake8 app/ tests/ --max-complexity=10
black app/ tests/ --line-length=79
```

---

## üîß Detailed Implementation (Full Guide)

**For comprehensive implementation details, see CLAUDE_structured.md**

### Quick Reference: Project Architecture
```
./
‚îú‚îÄ‚îÄ app/a2a/        # Source code (dependencies: bottom ‚Üí top)
‚îú‚îÄ‚îÄ tests/          # Test code  
‚îú‚îÄ‚îÄ memory-bank/    # AI context and knowledge
‚îú‚îÄ‚îÄ output/         # Build artifacts (git ignored)
‚îî‚îÄ‚îÄ scripts/        # Utility scripts
```

### Quick Reference: TDD Process
1. **Red**: Write failing test first
2. **Green**: Minimal implementation to pass  
3. **Refactor**: Improve quality without changing behavior

### Quick Reference: Security Rules
- ‚ùå Never expose secrets: `cat .env`, `echo $API_KEY`
- ‚úÖ Always validate inputs with Pydantic
- ‚úÖ Check for malicious patterns in user input

---

## üìö Reference & Examples

### Most Used Commands
```bash
# Development
poetry install && poetry shell
uvicorn app.a2a_mvp.server.app:app --reload

# Testing
pytest tests/unit/test_skills/test_task_skills.py -v
pytest --cov=app --cov-report=html

# Quality
flake8 app/ tests/ --statistics
black app/ tests/ --check --diff
mypy app/ --show-error-codes

# Docker
make              # Start environment
make bash         # Access container
make clean        # Clean up

# Progress Recording (Required)
ls memory-bank/06-project/progress/           # View all progress files
echo "üìã Rules: memory-bank/09-meta/progress_recording_mandatory_rules.md"
echo "‚úÖ Checklist: memory-bank/09-meta/session_start_checklist.md"
```

### Cognee Strategic Operations
```bash
# Status & Performance Check
mcp__cognee__cognify_status
time mcp__cognee__search "performance test" GRAPH_COMPLETION

# Strategic Search (3-stage optimization)
mcp__cognee__search "query" CHUNKS        # Phase 1: Fast metadata (1-3s)
mcp__cognee__search "query" RAG_COMPLETION # Phase 2: Semantic (5-10s)
mcp__cognee__search "query" GRAPH_COMPLETION # Phase 3: Comprehensive (10-20s)

# Knowledge Management
mcp__cognee__cognee_add_developer_rules --base_path /home/devuser/workspace
mcp__cognee__cognify --data "new knowledge content"

# Strategic Navigation
# üìö Comprehensive strategy: memory-bank/01-cognee/cognee_effective_utilization_strategy.md
# üö® Emergency reconstruction: memory-bank/01-cognee/cognee_reconstruction_successful_procedure.md  
# üöÄ Performance optimization: memory-bank/01-cognee/search_speed_optimization_and_indexing_strategy.md
# üìã Daily utilization: memory-bank/01-cognee/mandatory_utilization_rules.md
```

### Emergency & Strategic Protocols
```bash
# Cognee Strategic Assessment
if mcp__cognee__cognify_status > /dev/null 2>&1; then
    # Performance assessment
    start_time=$(date +%s)
    mcp__cognee__search "test" GRAPH_COMPLETION >/dev/null 2>&1
    response_time=$(($(date +%s) - start_time))
    
    if [[ $response_time -gt 10 ]]; then
        echo "‚ö†Ô∏è PERFORMANCE ISSUE: ${response_time}s response time"
        echo "üöÄ Apply: memory-bank/01-cognee/search_speed_optimization_and_indexing_strategy.md"
    else
        echo "‚úÖ Cognee optimal performance"
    fi
else
    echo "üö® COGNEE EMERGENCY: Database unavailable"
    echo "üìã 45min reconstruction: memory-bank/01-cognee/cognee_reconstruction_successful_procedure.md"
    echo "‚ö° Quick start: mcp__cognee__prune && mcp__cognee__cognee_add_developer_rules"
    echo "‚ö†Ô∏è Fallback: Direct constraint mode"
    cat memory-bank/*_mandatory_rules.md | grep -A 3 "MANDATORY" | head -20
fi

# Strategic Navigation Hub
echo "üìö Complete strategy: memory-bank/01-cognee/cognee_effective_utilization_strategy.md"
echo "üéØ ROI: 64% annual return, 7-month payback, 80% efficiency gains"
```

### üèÜ Competitive Organization Framework
```bash
# È´òÂ∫¶‰∏¶ÂàóÈñãÁô∫„ÉªÂìÅË≥™ÊúÄÈÅ©Âåñ„Ç∑„Çπ„ÉÜ„É†ÔºàÈáçË¶Å„ÉªË§áÈõëË™≤È°åÂêë„ÅëÔºâ

# ÈÅ©Áî®Âà§ÂÆö
if [[ $ISSUE_COMPLEXITY == "HIGH" ]] && [[ $QUALITY_REQUIREMENT == "MAXIMUM" ]]; then
    echo "üéØ Competitive OrganizationÈÅ©Áî®Êé®Â•®"
    echo "üìã Framework: memory-bank/02-organization/competitive_organization_framework.md"
    echo "‚öôÔ∏è Technical: memory-bank/02-organization/tmux_git_worktree_technical_specification.md"  
    echo "üë• Roles: memory-bank/02-organization/competitive_roles_workflows_specification.md"
    echo "üèÖ Quality: memory-bank/04-quality/competitive_quality_evaluation_framework.md"
    
    # Âç≥Â∫ßÂÆüË°å
    echo "üöÄ Quick start: ./scripts/tmux_worktree_setup.sh && ./scripts/tmux_session_start.sh"
    echo "üéØ Expected: 3Ëß£Ê±∫Á≠ñ‰∏¶ÂàóÈñãÁô∫ ‚Üí Â§öËßíË©ï‰æ° ‚Üí ÊúÄÈÅ©Ëß£ÈÅ∏Êäû"
    echo "üìä ROI: ÂìÅË≥™30%Âêë‰∏ä„ÉªÈù©Êñ∞50%Âêë‰∏ä„ÉªÊÑèÊÄùÊ±∫ÂÆö90%Á≤æÂ∫¶"
fi
```

### Current Project Status
- **Project**: A2A MVP - Test-Driven Development
- **Status**: ‚úÖ Implementation Complete  
- **Coverage**: 92% (target: ‚â•85%)
- **Tests**: 101 tests, 100% passing
- **Quality**: Flake8 0 violations, Black formatted

---

## üö® Final Reminders

1. **Always run pre_action_check.py first** - Constraint validation
2. **Always write tests first** - TDD mandatory
3. **3-second rule** - Fact vs speculation check
4. **Quality gates before commit** - Non-negotiable
5. **When in doubt, write a test!**

**Key Principle**: ‰∫ãÂÆü„Éô„Éº„ÇπÂà§Êñ≠ - No speculation, only verified facts.

---

**Note**: This is Phase 1 implementation focusing on immediate usability. For complete details, reference memory-bank/ files and CLAUDE_structured.md.