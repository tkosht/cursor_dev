# デバッグのベストプラクティス (Debugging Best Practices)

## 🎯 目的
効率的かつ効果的なデバッグを通じて、問題の根本原因を迅速に特定し解決する。

## 共通原則

1.  **問題を正確に理解する:**
    *   何が起きているのか？（現象）
    *   何が期待される動作だったのか？（仕様・期待値）
    *   いつから発生しているのか？（時間軸）
    *   特定の条件下でのみ発生するのか？（再現条件）

2.  **再現性を確保する:**
    *   問題を確実に再現できる手順を確立する。再現できなければ根本解決は難しい。
    *   最小の再現コード (Minimal Reproducible Example) を作成することを試みる。

3.  **情報を収集する:**
    *   エラーメッセージ、スタックトレース。
    *   関連するログ（DEBUGレベル推奨）。
    *   実行環境（OS、ライブラリバージョン、設定ファイル）。
    *   最近の変更点（コード、設定、環境）。

4.  **仮説を立てて検証する:**
    *   収集した情報に基づいて、問題の原因に関する仮説を立てる。
    *   仮説を検証するための具体的なテストや調査方法を計画する。
    *   一度に一つの仮説を検証し、結果を記録する。

5.  **段階的に切り分ける (Divide and Conquer):**
    *   複雑な問題は、より小さなコンポーネントや機能単位に分割して調査する。
    *   問題が発生する箇所と発生しない箇所を特定し、範囲を狭める。
    *   正常に動作する箇所とそうでない箇所を比較する。

6.  **ログを戦略的に活用する:**
    *   適切なログレベル（DEBUG, INFO, WARNING, ERROR）を設定・活用する。
    *   重要な変数の値、処理の通過点、条件分岐の結果などをログに出力する。
    *   ログのパターンや時系列を分析し、問題発生の経緯を追跡する。

7.  **ツールを効果的に使用する:**
    *   デバッガ（ステップ実行、ブレークポイント、変数監視）。
    *   リンター、静的解析ツール（潜在的なバグの早期発見）。
    *   プロファイラ（パフォーマンス問題の特定）。
    *   バージョン管理システム（変更点の追跡、問題発生バージョンの特定）。

8.  **根本原因を追求する (Root Cause Analysis - RCA):**
    *   表面的な現象や一時的な対処療法で満足せず、なぜその問題が発生したのかという根本的な原因を突き止める。
    *   「なぜなぜ分析 (5 Whys)」などの手法を活用する。
    *   同じ問題が再発しないように、根本原因に対する恒久的な対策を講じる。

9.  **変更は一つずつ行い、結果を確認する:**
    *   複数の変更を一度に行うと、どの変更が効果的だったのか、あるいは新たな問題を引き起こしたのかが分からなくなる。
    *   小さな変更を一つずつ適用し、その都度動作確認を行う。

10. **ドキュメントと既存の知識を活用する:**
    *   公式ドキュメント、API仕様書、過去のバグレポート、ナレッジベースなどを参照する。
    *   類似の問題が過去に解決されていないか調査する。

11. **AIアシスタントとしてのデバッグ姿勢:**
    *   **客観性:** 自身の生成したコードや提案に対しても批判的な視点を持つ。
    *   **責任感:** 安易に外部要因やユーザー環境のせいにせず、まず自身の分析やコードを疑う。
    *   **透明性:** デバッグプロセス、試したこと、得られた結果をユーザーと明確に共有する。
    *   **協調性:** ユーザーからのフィードバックや指摘を真摯に受け止め、共同で問題解決にあたる。
    *   **学習意欲:** 未知のエラーや技術に遭遇した場合、積極的に情報を収集し学習する。

12. **休憩と視点の転換:**
    *   長時間同じ問題に取り組んで行き詰った場合は、一度休憩を取ったり、別のタスクを行ったりして視点を変えることが有効。

## 🚫 アンチパターン (避けるべきこと)

-   **当てずっぽうの修正 (Shotgun Debugging):** 根拠なく手当たり次第にコードを修正すること。
-   **エラーメッセージの無視:** エラーメッセージをよく読まずに修正を試みること。
-   **早すぎる最適化:** まずは正しく動作させることを優先する。
-   **同じ過ちの繰り返し:** 過去のデバッグ経験や教訓を活かさないこと。
-   **ドキュメント化の怠慢:** 解決策や重要な発見を記録に残さないこと。

---
**最終更新:** 2025-05-31 (Gemini API E2Eテストデバッグの教訓を反映) 