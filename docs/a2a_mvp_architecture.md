# A2A MVP アーキテクチャ設計

## 概要
本ドキュメントは、A2Aプロトコルを使用したMVP開発のためのモジュール構成を定義します。
実践例として、タスク管理エージェント（TODO管理）を実装します。

## モジュール構成

```
app/
├── a2a_mvp/
│   ├── __init__.py
│   ├── core/               # コアプロトコル層
│   │   ├── __init__.py
│   │   ├── protocol.py     # A2Aプロトコル基本実装
│   │   ├── types.py        # 共通型定義
│   │   └── exceptions.py   # カスタム例外
│   │
│   ├── agents/             # エージェント層
│   │   ├── __init__.py
│   │   ├── base.py         # 基底エージェントクラス
│   │   ├── task_agent.py   # タスク管理エージェント
│   │   └── registry.py     # エージェントレジストリ
│   │
│   ├── skills/             # スキル層
│   │   ├── __init__.py
│   │   ├── base.py         # 基底スキルクラス
│   │   ├── task_skills.py  # タスク管理スキル
│   │   └── validators.py   # 入力検証
│   │
│   ├── storage/            # ストレージ層
│   │   ├── __init__.py
│   │   ├── interface.py    # ストレージインターフェース
│   │   ├── memory.py       # インメモリストレージ
│   │   └── persistent.py   # 永続化ストレージ
│   │
│   ├── server/             # サーバー層
│   │   ├── __init__.py
│   │   ├── app.py          # FastAPIアプリケーション
│   │   ├── handlers.py     # リクエストハンドラー
│   │   └── middleware.py   # ミドルウェア
│   │
│   └── client/             # クライアント層
│       ├── __init__.py
│       ├── a2a_client.py   # A2Aクライアント
│       └── cli.py          # CLIインターフェース

tests/
├── unit/
│   ├── test_core/
│   ├── test_agents/
│   ├── test_skills/
│   └── test_storage/
├── integration/
│   ├── test_server/
│   └── test_client/
└── e2e/
    └── test_task_management.py
```

## 設計原則

### 1. 責任の分離
- **Core**: プロトコル仕様の実装
- **Agents**: ビジネスロジックの実装
- **Skills**: 具体的な機能の実装
- **Storage**: データ永続化の抽象化
- **Server/Client**: 通信層の実装

### 2. テスタビリティ
- 各層は独立してテスト可能
- 依存性注入パターンの使用
- モックしやすいインターフェース設計

### 3. 拡張性
- 新しいエージェント/スキルの追加が容易
- ストレージバックエンドの切り替え可能
- プラグイン機構のサポート

## 実装するタスク管理エージェントの機能

### 基本機能（MVP）
1. タスクの作成（Create）
2. タスク一覧の取得（Read）
3. タスクの更新（Update）
4. タスクの削除（Delete）
5. タスクの完了/未完了切り替え

### 拡張機能（将来）
- タスクの優先度設定
- 期限管理
- タグ/カテゴリ機能
- タスクの検索/フィルタリング
- 複数ユーザー対応

## TDD実装順序

1. **Core層のテストと実装**
   - 型定義のテスト
   - プロトコル基本機能のテスト

2. **Storage層のテストと実装**
   - インターフェース定義
   - インメモリ実装

3. **Skills層のテストと実装**
   - タスク管理スキルのテスト
   - 入力検証のテスト

4. **Agents層のテストと実装**
   - 基底クラスのテスト
   - タスク管理エージェントのテスト

5. **Server/Client層のテストと実装**
   - HTTPエンドポイントのテスト
   - クライアントAPIのテスト

6. **統合テスト**
   - エージェントとサーバーの統合
   - クライアントとサーバーの統合

7. **E2Eテスト**
   - 完全なワークフローのテスト