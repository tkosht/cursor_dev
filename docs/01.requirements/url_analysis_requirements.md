# URL分析要件定義

## 1. 目的
- 企業情報に関連するURLを高精度で特定する
- 最新の情報を確実に取得する

## 2. 機能要件

### 2.1 URL関連性分析
#### 2.1.1 分析対象
- サイトマップから取得したURL
- ナビゲーションメニューから取得したURL
- フッターリンクから取得したURL

#### 2.1.2 分析プロセス
1. URL構造解析
   - パスコンポーネントの分解（例: "/company/about/history" → ["company", "about", "history"]）
   - クエリパラメータの解析（例: "?lang=ja&category=corporate"）
   - 言語情報の特定（例: "/en/", "/ja/" などのパス情報）

2. LLMによる意味解析
   - 入力: 分解したURL情報
   - 処理: 
     - 各パスコンポーネントの意味理解
     - 企業情報との関連性判定
     - カテゴリ分類（会社概要、IR情報など）
   - 出力:
     - 関連性スコア（0-1の数値）
     - 判断理由（自然言語での説明）
     - ページカテゴリ

3. フィルタリング
   - 関連性スコアによる選別（0.4以上を関連ページとして抽出）
   - 重複コンテンツの除外
   - 外部ドメインの除外

#### 2.1.3 分析精度要件
- 適合率（Precision）: 80%以上
  - 抽出した企業情報ページが実際に企業情報である確率
- 再現率（Recall）: 90%以上
  - 存在する企業情報ページを漏れなく抽出できる確率

#### 2.1.4 分析結果
各URLに対して以下の情報を提供：
```json
{
    "url": "対象URL",
    "relevance_score": "関連性スコア（0-1）",
    "category": "ページカテゴリ（company_profile/corporate_info/ir_info等）",
    "reason": "判断理由の説明",
    "confidence": "判定の信頼度（0-1）"
}
```

### 2.2 情報の鮮度
- キャッシュを使用せず、常に最新の情報を取得
- 各URLに対して個別に評価を実施

### 2.3 並列処理
- 複数URLの同時評価
- サーバー負荷を考慮した同時接続数の制限

## 3. 非機能要件

### 3.1 性能要件
- URL評価の応答時間：最大5秒/URL
- 同時評価可能URL数：最大5件

### 3.2 信頼性要件
- 誤判定率：5%以下
- LLM評価の信頼性スコア：0.8以上

### 3.3 拡張性要件
- 新しい企業情報カテゴリーへの対応
- 多言語サイトへの対応

## 4. 制約条件
- robots.txtの遵守
- サイトのレート制限への対応
- クローリングの礼儀正しさ（politeness）の確保 