<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>企業情報クロール・分析システム 要件定義書 (MVP)</title>
    <style>
        body {
            font-family: sans-serif;
            margin: 2em;
            line-height: 1.6;
        }
        h1, h2, h3, h4 {
            color: #333;
            margin-top: 1.5em;
            margin-bottom: 0.5em;
        }
        ul {
            margin-bottom: 1em;
        }
        li {
            margin-bottom: 0.3em;
        }
        table {
            border-collapse: collapse;
            margin-bottom: 1em;
        }
        table, th, td {
            border: 1px solid #ccc;
        }
        th, td {
            padding: 0.5em;
            text-align: left;
        }
        .note {
            color: #999;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <h1>企業情報クロール・分析システム 要件定義書 (MVP)</h1>

    <h2>1. はじめに / 目的 (Introduction & Purpose)</h2>
    <p>
        本ドキュメントは、Web上に公開されている上場企業の情報を自動的に収集・標準化し、分析可能な形で提供するシステムに関する要件定義書である。<br>
        MVP（Minimum Viable Product）として、まずは限定的な企業数とデータ項目に焦点を当て、早期に動く仕組みを提供し、実運用から得られるフィードバックを基に拡張・改善を行うことを目的とする。
    </p>

    <h2>2. システム概要 / スコープ (System Overview & Scope)</h2>
    <h3>2.1 システム概要</h3>
    <ul>
        <li>対象企業：日本国内の上場企業を中心に、MVPでは最大100社程度を想定。</li>
        <li>収集対象情報：企業基本情報、財務情報（売上高や営業利益など）、ニュース記事やプレスリリース等。</li>
        <li>分析機能：収集データを用いた企業横断的な集計・可視化を行い、市場調査や競合比較、投資判断などを支援する。</li>
    </ul>

    <h3>2.2 スコープ (MVP範囲)</h3>
    <ul>
        <li><strong>情報収集機能:</strong> 公式サイト・IR情報・主要ニュースサイト（例: 日経新聞、Bloomberg 等）からのクローリング。</li>
        <li><strong>データ標準化機能:</strong> 企業エンティティおよびニュース・財務エンティティを想定し、必要事項を共通フォーマットへ変換。</li>
        <li><strong>データ保存機能:</strong> リレーショナルデータベース（例: PostgreSQL）への格納（Company, Financial, Newsテーブルなど）。</li>
        <li><strong>分析・可視化機能:</strong> 集計結果をグラフや表で示し、BIツール（例: Tableau Public 等）で活用可能な形式（CSV出力など）を提供。</li>
        <li>上記以外（特許情報、ESG、PDF解析等）や外部システム連携はMVP範囲外。</li>
    </ul>

    <h2>3. 前提条件 (Assumptions)</h2>
    <ul>
        <li>クローリングの対象企業リストは、管理者がCSV等で準備する。</li>
        <li>クローリング頻度は週1回〜日1回程度を想定し、対象サイトの利用規約やrobots.txtを遵守する。</li>
        <li>APIやRSSが利用できる情報源では、それらを優先し、HTMLスクレイピングは補助的に利用する。</li>
        <li>大規模分散処理はMVPフェーズでは不要。クラウド上の単一サーバーやバッチジョブで対応可能と想定。</li>
    </ul>

    <h2>4. 非機能要件 (Non-functional Requirements)</h2>
    <h3>4.1 性能・スケーラビリティ</h3>
    <ul>
        <li>情報収集：最大100社の企業情報を週1回〜日1回の頻度で収集し、1週間以内で全データを取得完了できること。</li>
        <li>データ変換：収集したデータを1日以内に標準化処理できること。</li>
        <li>ダッシュボード表示：基本的な分析結果の表示に5秒以内で応答できること。</li>
        <li>将来的に企業数が増加した場合は、クラウドバッチや分散処理を導入して拡張を検討する。</li>
    </ul>

    <h3>4.2 セキュリティ・アクセス制御</h3>
    <ul>
        <li>MVPでは認証機能を実装せず、アクセスを開発者に限定する。</li>
        <li>DBおよびクローリングジョブへのアクセスは最低限の権限で行い、不要なポート開放は行わない。</li>
        <li>収集データの保管先は限定的なアクセス権を持つ環境とし、鍵や証明書などの秘密情報は安全に管理する。</li>
    </ul>

    <h3>4.3 可用性・保守性</h3>
    <ul>
        <li>週5日稼働（メンテナンス除く）を目標とする。</li>
        <li>計画的なメンテナンスは事前通知とし、サイト構造変更に伴うスクレイピングルールの更新フローを確立する。</li>
        <li>ログ出力によりクローリング失敗や取得エラーを監視し、問題特定を容易にする。</li>
    </ul>

    <h2>5. 機能要件 (Functional Requirements)</h2>
    <h3>5.1 情報収集</h3>
    <h4>5.1.1 対象企業リスト管理</h4>
    <ul>
        <li>対象企業リスト（例: CSVファイル）を読み込み、管理画面や手動更新でメンテナンス可能とする。</li>
    </ul>
    <h4>5.1.2 クローリングおよび情報源管理</h4>
    <ul>
        <li>企業公式サイト（会社概要、IR情報）や主要ニュースサイト・プレスリリースサイトから自動収集。</li>
        <li>クロールのスケジュール（週1回〜日1回）とレートリミット（1秒あたり2リクエスト等）を設定し、アクセス負荷を調整。</li>
        <li>robots.txt 及び利用規約を遵守し、不正アクセスにならないよう配慮。</li>
        <li>クロール進捗やエラーをログに記録し、必要に応じて通知する。</li>
    </ul>
    <h4>5.1.3 データ抽出</h4>
    <ul>
        <li>企業基本情報：企業名（表記ゆれを統一）、本社所在地、設立年月日、業種、代表者名、法人番号（取得可能な場合）。</li>
        <li>財務情報：売上高、営業利益、純利益、会計年度・四半期など。</li>
        <li>ニュース／プレスリリース情報：タイトル、掲載日、メディア名、本文または要約、記事URL。</li>
        <li>抽出ルールはXPathまたはCSSセレクタ（設定ファイル）に定義し、サイト構造変更に対応可能な設計とする。</li>
    </ul>

    <h3>5.2 データ標準化</h3>
    <h4>5.2.1 データモデル</h4>
    <ul>
        <li>Companyエンティティ：企業名、所在地、設立年、代表者などの基本属性を保持。</li>
        <li>Financialエンティティ：売上高、営業利益、純利益、決算期などの財務属性を保持。</li>
        <li>Newsエンティティ：ニュース・プレスリリースに関する情報を保持。</li>
    </ul>
    <h4>5.2.2 データ変換および名寄せ</h4>
    <ul>
        <li>日付や通貨、数値のフォーマットを統一し、ISO 8601等の基準に準拠する。</li>
        <li>撤退企業や社名変更が発生した場合の取り扱いルールを策定する。</li>
        <li>企業名と法人番号などをキーに同一企業を名寄せし、重複登録を防止。</li>
    </ul>

    <h3>5.3 データ保存</h3>
    <ul>
        <li>PostgreSQLなどのRDBを使用し、Company, Financial, News等のテーブルに分割して保存。</li>
        <li>更新情報は日時を付与してバージョン管理を行い、過去データの追跡を可能とする。</li>
    </ul>

    <h3>5.4 分析・可視化</h3>
    <h4>5.4.1 基本集計</h4>
    <ul>
        <li>企業数、業種別企業数の集計、企業ごとの財務指標の集計 (売上高推移など)。</li>
        <li>企業ごとのニュース／プレスリリース件数や頻度の把握。</li>
    </ul>
    <h4>5.4.2 可視化・連携</h4>
    <ul>
        <li>棒グラフ・円グラフなどの簡易的な可視化、またはBIツール連携 (Tableau Public など) を想定。</li>
        <li>CSVやJSONなどのエクスポート機能で外部ツールとの連携を支援。</li>
    </ul>

    <h2>6. 運用プロセス</h2>
    <ol>
        <li><strong>対象企業リスト登録：</strong>CSVなどで上場企業リストをアップデート。</li>
        <li><strong>定期クローリング実行：</strong>週1回または日1回のスケジュールで、IRサイトやニュースサイトを巡回し、API／RSS／HTMLスクレイピングで情報取得。</li>
        <li><strong>データクレンジング・標準化：</strong>文字化けや不要タグ除去、日付・数値フォーマット統一。</li>
        <li><strong>データ保存：</strong>重複検知やバリデーション後、Company・Financial・Newsテーブルへ登録。</li>
        <li><strong>分析・可視化：</strong>集計結果をCSVやBIツールへ出力し、業種別比較や企業別推移などを可視化。</li>
        <li><strong>エラー調査・運用保守：</strong>サイト構造変更やスクレイピング失敗時のログ確認・修正対応。</li>
    </ol>

    <h2>7. 法的・倫理的側面</h2>
    <ul>
        <li>スクレイピング対象サイトのrobots.txtや利用規約を遵守。</li>
        <li>ニュース本文・プレスリリースを保管・再利用する場合、著作権や知的財産権に注意。必要に応じて要約のみを保存。</li>
        <li>個人情報や機密情報はMVPでは扱わない。将来的に取り扱う場合は追加のプライバシー対策を講じる。</li>
    </ul>

    <h2>8. リスク・課題 (Risks and Issues)</h2>
    <ul>
        <li>対象サイトのレイアウト変更やアクセス制限によりクローリングが失敗するリスク。</li>
        <li>企業数・データ量の増加に伴い、DBパフォーマンス・スケール問題が発生する可能性。</li>
        <li>利用規約・著作権抵触リスクがあるため、サイト側との調整や引用方法に注意。</li>
        <li>財務情報の区切り時期（四半期・年度）や表記ゆれにより、正確な集計を行えない場合がある。</li>
    </ul>

    <h2>9. 制約事項 (Constraints)</h2>
    <ul>
        <li>開発期間：3ヶ月</li>
        <li>開発リソース：エンジニア1名</li>
        <li>利用技術スタック：Python, PostgreSQL, (必要に応じて) Tableau Public</li>
    </ul>

    <h2>10. 受け入れ条件 (Acceptance Criteria)</h2>
    <ul>
        <li>指定した業界・企業の基本情報・財務情報・ニュース情報が定期的に収集できる。</li>
        <li>収集データは定義されたデータモデルに基づき、DBへ適切に保存されている。</li>
        <li>基本的な分析（企業数、業種別、売上推移など）および可視化が週5日安定して行える。</li>
        <li>非機能要件（性能、セキュリティ、可用性など）の目標を満たしている。</li>
    </ul>

    <h2>11. 承認・更新履歴 (Approval & Revision History)</h2>
    <table>
        <thead>
            <tr>
                <th>バージョン</th>
                <th>更新日</th>
                <th>更新内容</th>
                <th>更新者</th>
                <th>承認</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>0.1 (Draft)</td>
                <td>YYYY-MM-DD</td>
                <td>初版ドキュメント作成</td>
                <td>作成者名</td>
                <td>承認者名</td>
            </tr>
        </tbody>
    </table>

    <p class="note">
        ※本ドキュメントは、運用の過程で追加・変更される場合があります。
    </p>

</body>
</html> 