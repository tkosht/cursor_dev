# Adoptive Market Crawler

# 要件

- 指定されたキーワードに関する市場分析に役立ちそうな情報(企業に関する情報、各種サービス、ビジネストレンド等に限定されない)の情報を収集しナレッジ化
- ページに依存しない汎用ナレッジ化
	- 市場に影響を与えるような記事を検索・特定し、内容を整理してナレッジ化
	- 上場企業等の代表的な企業HPの情報を整理してナレッジ化
	- 情報の整理には、HTMLパーサでの単純な解析ではなく、LLM(Gemini)を用いたコンテンツ変化に適応的に解析ができること


## 目的
・市場分析に有益となる情報(企業に関する情報、サービス情報、ビジネストレンド等)を収集し、Gemini-2.0-flash等を用いて解析し、その結果をNeo4jデータベースにナレッジとして保存する。
・代表的な企業のHPや市場に影響を与えそうな記事に注目し、情報を整理・分析。
・HTMLパーサの単純解析にとどまらず、LLM(Gemini)を活用してコンテンツ変化に柔軟に対応。



## 主要機能

- テキスト抽出
	- HTMLからの本文抽出や不要要素の除去、正規化など。
- Geminiによる解析
	- gemini-2.0-flash-exp を利用。
	- 市場影響度や企業動向、トレンドなどを分析。
- ナレッジ保存
	- Neo4jに分析結果を保存し、時系列での変化を管理。

## 制約・連携

- 広告や関係のない情報を取り込まないようプロンプトを工夫。
- Geminiのバージョンはgemini-2.0-flash-expを使用する。
- Neo4jの認証情報(ユーザ名、パスワード)やホストなどは環境変数で管理し、ナレッジを永続化する。
	- Gemini は、`gemini-2.0-flash-exp`
		- APIキー: .env の `GOOGLE_API_KEY_GEMINI`
	- ナレッジ化は、neo4j データベースに記録する
		- Neo4jユーザ: .env の `neo4j_user`
		- Neo4jパスワード: .env の `neo4j_pswd`
		- Neo4jサーバ: `neo4j`

## データ構造とスキーマ

- ExtractedText
- 抽出された本文、情報源種別、抽出日時など。
- MarketAnalysis
- 市場影響度(0.0〜1.0)、市場トレンド、分析洞察など。
- Knowledge (Neo4jのノード例)
- content: 解析内容
- source: 情報源
- timestamp: 評価日時
- impact: 市場影響度
- trends: 市場トレンド
- 関係性 (Neo4jのリレーションシップ)
- INFLUENCES / COMPETES / DEVELOPS / PARTICIPATESなどの種類。
- descriptionやstrength(強度)等のプロパティ。

## システムフロー概要

- テキスト抽出
	- 対象URLからHTMLを取得し、テキストを抽出・正規化。
	- 市場分析
- Geminiを用いてコンテンツを解析。
	- 市場影響度を算出し、関係性やトレンドを抽出。
- ナレッジ保存
	- 抽出したエンティティをノードとして登録。
	- エンティティ間の関係性をリレーションシップとして登録。
	- 既存エンティティやリレーションシップがあれば更新する。

■ 実装／テスト関連

- KnowledgeManagerやContentAnalyzer等のクラスを通して、エンティティ（ノード）および関係性（リレーションシップ）の作成・更新・取得を行う。
- テストではGeminiサービスのモックやNeo4j接続のモックを用い、関係性やノードが正しく生成・更新されるかを確認している。
- integrationテストでは実際のGeminiサービスを用いた関係性抽出が行われる。

これらの要件や設計から、システム全体として「HTML等から得た市場関連情報をLLMで解析し、考慮すべき関係性や影響度をNeo4jのグラフ構造に整理して蓄積する」という流れが主眼となっています。
